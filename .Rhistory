document()
library(devtools)
library(roxygen2)
document()
?dawww
document()
?dawww
dawww("smolbabe")
?cgaR
devtools::install_github("mcgregorian1/cgaR")
library(cgaR)
?cgaR
?cgaR
document()
DownloadSentinel2("17SNA", "D:/", L2Flag = TRUE, rexExp = "S2\\D_MSIL\\d\\D_201([6]|[8][0][0-9]).*.SAFE/$")
#'
#' @param tilename what tile do you want to download
#' @param folder local folder used to store downloaded files
#' @param L2Flag indicate to download L2A product or L1C product (default)
#' @param regExp regular expression, with which you can specify which files you want. For example,
#' regExp <- "S2\\D_MSIL\\d\\D_201([6]|[8][0][0-9]).*.SAFE/$" means you want data from 2016 and before 2018 before October.
#' @keywords sentinel
#' @export
#' @examples
#' DownloadSentinel2("17SNA", "D:/", L2Flag = TRUE, rexExp = "S2\\D_MSIL\\d\\D_201([6]|[8][0][0-9]).*.SAFE/$")
DownloadSentinel2 <- function(tilename, folder, L2Flag = FALSE, regExp = NULL) {
gcUrl <- ifelse(L2Flag == TRUE, file.path("gs://gcp-public-data-sentinel-2/L2/tiles", substr(tilename, 1, 2),
substr(tilename, 3, 3), substr(tilename, 4, 5)),
file.path("gs://gcp-public-data-sentinel-2/tiles", substr(tilename, 1, 2),
substr(tilename, 3, 3), substr(tilename, 4, 5)))
com <- paste("gsutil ls", gcUrl)
fileList <- system(com, intern = TRUE) # View(fileList)
# create destination folder
destDir <- folder
if (dir.exists(file.path(destDir, tilename)) == FALSE) dir.create(file.path(destDir, tilename))
# regular expression filter
if (!is.null(regExp)) fileList <- grep(regExp, fileList, value = TRUE)
# started downloading
for (i in 1:length(fileList)) {
temp <- unlist(strsplit(fileList[i], "/"))
dirname <- temp[length(temp)]
if (dir.exists(file.path(destDir, tilename, dirname)) == FALSE) {
system(paste("gsutil -m cp -r", fileList[i], file.path(destDir, tilename, ".")))
}
}
}
debugSource('Q:/My Drive/github/cgaR/R/DownloadSentinel2.R')
fileList
grepl("2017", fileList)
fileList <- system(com, intern = TRUE) # View(fileList)
grepl("2017", fileList)
